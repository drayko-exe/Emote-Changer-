local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Menu de Modificações | drayko",
   LoadingTitle = "Carregando Scripts...",
   LoadingSubtitle = "by drayko",
   ConfigurationSaving = {
      Enabled = false
   }
})

-- ==========================================
-- VARIÁVEIS GERAIS
-- ==========================================
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Estados
local platAtiva = false
local modoVisivel = false
local bhopAtivo = false
local ultimaPlataforma = nil

-- Variáveis do BHOP Avançado
local LastJump = 0
local JUMP_COOLDOWN = 0.15
local GROUND_CHECK_DISTANCE = 3.5
local MAX_SLOPE_ANGLE = 45

local pastaPlataformas = workspace:FindFirstChild("PlataformasInvisiveis") or Instance.new("Folder", workspace)
pastaPlataformas.Name = "PlataformasInvisiveis"

-- ==========================================
-- FUNÇÃO BHOP AVANÇADA (Extraída do seu script)
-- ==========================================
local function IsOnGround(Character, HRP, Humanoid)
    if not Character or not HRP or not Humanoid then return false end

    local state = Humanoid:GetState()
    if state == Enum.HumanoidStateType.Jumping or 
       state == Enum.HumanoidStateType.Freefall or
       state == Enum.HumanoidStateType.Swimming then
        return false
    end

    local raycastParams = RaycastParams.new()
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    raycastParams.FilterDescendantsInstances = {Character}
    raycastParams.IgnoreWater = true

    local rayOrigin = HRP.Position
    local rayDirection = Vector3.new(0, -GROUND_CHECK_DISTANCE, 0)
    local raycastResult = workspace:Raycast(rayOrigin, rayDirection, raycastParams)

    if not raycastResult then return false end

    local surfaceNormal = raycastResult.Normal
    local angle = math.deg(math.acos(surfaceNormal:Dot(Vector3.new(0, 1, 0))))

    return angle <= MAX_SLOPE_ANGLE
end

-- Hook do Bhop no Loop do Coração (Heartbeat)
RunService.Heartbeat:Connect(function()
    if not bhopAtivo then return end
    
    local Character = player.Character
    if Character then
        local Humanoid = Character:FindFirstChildOfClass("Humanoid")
        local HRP = Character:FindFirstChild("HumanoidRootPart")
        
        if Humanoid and Humanoid.Health > 0 and HRP then
            local now = tick()
            -- Checa se o jogador está segurando Espaço e se está no chão
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) and IsOnGround(Character, HRP, Humanoid) and (now - LastJump) > JUMP_COOLDOWN then
                Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
                LastJump = now
            end
        end
    end
end)

-- ==========================================
-- ABA SCRIPTS
-- ==========================================
local Tab = Window:CreateTab("Scripts", 4483362458)

Tab:CreateSection("Visual")

Tab:CreateButton({
   Name = "Ativar Shaders by drayko.exe",
   Callback = function()
      loadstring(game:HttpGet("https://raw.githubusercontent.com/drayko-exe/shaders-by-drayko.exe/refs/heads/main/shaders%20by%20%40drayko.exe"))()
      Rayfield:Notify({Title = "Shaders", Content = "Script carregado via GitHub!", Duration = 3})
   end,
})

Tab:CreateSection("Movimentação")

Tab:CreateToggle({
   Name = "Bhop (Pulo Perfeito)",
   CurrentValue = false,
   Flag = "BhopToggle",
   Callback = function(Value)
      bhopAtivo = Value
   end,
})

Tab:CreateSection("Emotes")

Tab:CreateToggle({
   Name = "Renomear Emotes",
   CurrentValue = false,
   Flag = "EmoteToggle",
   Callback = function(Value)
      local Emotes = game:GetService("ReplicatedStorage"):WaitForChild("Items"):WaitForChild("Emotes")
      if Value then
         if Emotes:FindFirstChild("WerewolfHowl") then Emotes.WerewolfHowl.Name = "GoofyStride" end
         if Emotes:FindFirstChild("Griddy") then Emotes.Griddy.Name = "BumperKart" end
         if Emotes:FindFirstChild("SkateboardStroll") then Emotes.SkateboardStroll.Name = "Nostalgia" end
      else
         if Emotes:FindFirstChild("GoofyStride") then Emotes.GoofyStride.Name = "WerewolfHowl" end
         if Emotes:FindFirstChild("BumperKart") then Emotes.BumperKart.Name = "Griddy" end
         if Emotes:FindFirstChild("Nostalgia") then Emotes.Nostalgia.Name = "SkateboardStroll" end
      end
   end,
})

Tab:CreateSection("Plataformas")

Tab:CreateToggle({
   Name = "Habilitar Teclas (E, Y, U)",
   CurrentValue = false,
   Flag = "PlatToggle",
   Callback = function(Value)
      platAtiva = Value
      if not Value then pastaPlataformas:ClearAllChildren() end
   end,
})

-- ==========================================
-- ABA SOCIAL
-- ==========================================
local SocialTab = Window:CreateTab("Social", 4483362458)

SocialTab:CreateSection("by drayko")

SocialTab:CreateButton({
   Name = "Copiar Discord",
   Callback = function()
      setclipboard("https://discord.gg/bqgVRCWm")
      Rayfield:Notify({Title = "Sucesso", Content = "Discord copiado!", Duration = 3})
   end,
})

SocialTab:CreateButton({
   Name = "TikTok (@drayko.exe)",
   Callback = function()
      setclipboard("https://www.tiktok.com/@drayko.exe")
      Rayfield:Notify({Title = "Sucesso", Content = "TikTok copiado!", Duration = 3})
   end,
})

-- ==========================================
-- LÓGICA DAS PLATAFORMAS
-- ==========================================
local function atualizarVisual()
    for _, parte in pairs(pastaPlataformas:GetChildren()) do
        parte.Transparency = modoVisivel and 0.3 or 1
        parte.Material = modoVisivel and Enum.Material.Neon or Enum.Material.Plastic
    end
end

local function criarMapa()
    local character = player.Character or player.CharacterAdded:Wait()
    local root = character:WaitForChild("HumanoidRootPart")
    local altura = root.Position.Y - 3

    for x = -500, 500, 8 do
        for z = -500, 500, 8 do
            local parte = Instance.new("Part")
            parte.Size = Vector3.new(8, 1, 8)
            parte.Position = Vector3.new(x, altura, z)
            parte.Anchored, parte.CanCollide = true, true
            parte.Transparency = modoVisivel and 0.3 or 1
            parte.Parent = pastaPlataformas
            ultimaPlataforma = parte
        end
    end
end

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed or not platAtiva then return end

    if input.KeyCode == Enum.KeyCode.E then
        if #pastaPlataformas:GetChildren() > 0 then
            pastaPlataformas:ClearAllChildren()
        else
            criarMapa()
        end
    end

    if input.KeyCode == Enum.KeyCode.Y then
        modoVisivel = not modoVisivel
        atualizarVisual()
    end

    if input.KeyCode == Enum.KeyCode.U and ultimaPlataforma then
        if player.Character then
            player.Character.HumanoidRootPart.CFrame = ultimaPlataforma.CFrame + Vector3.new(0, 3, 0)
        end
    end
end)

Rayfield:LoadConfiguration()
