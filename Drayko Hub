-- Desbloqueio de FPS Máximo
if setfpscap then
    setfpscap(9999)
end

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "Menu de Modificações | drayko",
   LoadingTitle = "Carregando Scripts...",
   LoadingSubtitle = "made by @drayko.exe",
   ConfigurationSaving = {
      Enabled = false
   }
})

-- ==========================================
-- VARIÁVEIS E CONFIGURAÇÕES
-- ==========================================
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")
local player = Players.LocalPlayer

local bhopAtivo = false
local platAtiva = false
local modoVisivel = false
local gravidadeZeroAtiva = false
local ultimaPlataforma = nil
local LastJump = 0

local JUMP_COOLDOWN = 0.15
local GROUND_CHECK_DISTANCE = 3.5
local MAX_SLOPE_ANGLE = 45

local pastaPlataformas = workspace:FindFirstChild("PlataformasInvisiveis") or Instance.new("Folder", workspace)
pastaPlataformas.Name = "PlataformasInvisiveis"

-- ==========================================
-- FUNÇÕES DE SUPORTE
-- ==========================================

local function IsOnGroundAdvanced()
    local Character = player.Character
    if not Character then return false end
    local Humanoid = Character:FindFirstChildOfClass("Humanoid")
    local HRP = Character:FindFirstChild("HumanoidRootPart")
    if not Humanoid or not HRP or Humanoid.Health <= 0 then return false end
    local raycastParams = RaycastParams.new()
    raycastParams.FilterType = Enum.RaycastFilterType.Exclude
    raycastParams.FilterDescendantsInstances = {Character}
    local rayOrigin = HRP.Position
    local rayDirection = Vector3.new(0, -GROUND_CHECK_DISTANCE, 0)
    local raycastResult = workspace:Raycast(rayOrigin, rayDirection, raycastParams)
    if not raycastResult then return false end
    local surfaceNormal = raycastResult.Normal
    local angle = math.deg(math.acos(surfaceNormal:Dot(Vector3.new(0, 1, 0))))
    return angle <= MAX_SLOPE_ANGLE
end

local function AdvancedRename(oldName, newName)
    for _, item in pairs(ReplicatedStorage:GetDescendants()) do
        if item.Name == oldName then
            item.Name = newName
        end
    end
end

-- ==========================================
-- ABA: COSMETICS
-- ==========================================
local CosmeticTab = Window:CreateTab("Cosmetics", 4483362458)

CosmeticTab:CreateSection("Personagem")

CosmeticTab:CreateButton({
   Name = "Universal Avatar Changer",
   Callback = function()
      loadstring(game:HttpGet("https://raw.githubusercontent.com/darkdexv2/universalavatarchanger/main/avatarchanger"))()
   end,
})

CosmeticTab:CreateSection("Efeitos Visuais (Toxic Auras)")

-- VERSÃO VERDE (ToxicAura Green)
CosmeticTab:CreateButton({
    Name = "ToxicAura (Green version)",
    Callback = function()
        local assetId = 14628750884
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local root = character:WaitForChild("HumanoidRootPart")
        
        local function loadAndCopyVFX()
            local success, model = pcall(function() return game:GetObjects("rbxassetid://" .. assetId)[1] end)
            if not success or not model then return end
            model.Parent = workspace
            local forwardPos = root.CFrame * CFrame.new(0, -3, -15)
            if model:IsA("Model") then
                if model.PrimaryPart then model:SetPrimaryPartCFrame(forwardPos)
                else local base = model:FindFirstChildWhichIsA("BasePart", true)
                if base then model:MoveTo(forwardPos.Position) end end
            end
            task.wait(1.5)
            local vfxFolder = workspace:FindFirstChild("VFX Auras")
            if not vfxFolder then return end
            local children = vfxFolder:GetChildren()
            if #children < 2 then return end
            local dummy = children[2] -- Lógica da versão verde (children[2])
            if not dummy or not dummy:IsA("Model") then return end
            local humanoid = character:WaitForChild("Humanoid")
            local isR15 = humanoid.RigType == Enum.HumanoidRigType.R15
            local partMapping = {
                ["Head"] = "Head",
                ["Torso"] = isR15 and "UpperTorso" or "Torso",
                ["Left Arm"] = isR15 and "LeftUpperArm" or "Left Arm",
                ["Right Arm"] = isR15 and "RightUpperArm" or "Right Arm",
                ["Left Leg"] = isR15 and "LeftUpperLeg" or "Left Leg",
                ["Right Leg"] = isR15 and "RightUpperLeg" or "Right Leg",
            }
            for sourceName, targetName in pairs(partMapping) do
                local sourcePart = dummy:FindFirstChild(sourceName, true)
                local targetPart = character:FindFirstChild(targetName, true)
                if sourcePart and targetPart then
                    for _, child in ipairs(sourcePart:GetChildren()) do
                        if child:IsA("Attachment") then child:Clone().Parent = targetPart end
                    end
                end
            end
        end
        loadAndCopyVFX()
    end
})

-- VERSÃO ROXA (ToxicAura Purple)
CosmeticTab:CreateButton({
    Name = "ToxicAura (Purple version)",
    Callback = function()
        local assetId = 14628750884
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local root = character:WaitForChild("HumanoidRootPart")

        local function loadAndCopyVFX()
            local success, model = pcall(function() return game:GetObjects("rbxassetid://" .. assetId)[1] end)
            if not success or not model then return end
            model.Parent = workspace
            local forwardPos = root.CFrame * CFrame.new(0, -3, -15)
            if model:IsA("Model") then
                if model.PrimaryPart then model:SetPrimaryPartCFrame(forwardPos)
                else local base = model:FindFirstChildWhichIsA("BasePart", true)
                if base then model:MoveTo(forwardPos.Position) end end
            end
            task.wait(1.5)
            local dummy
            for _, obj in ipairs(workspace:GetDescendants()) do
                if obj.Name == "Dummy" and obj:IsA("Model") then dummy = obj break end
            end
            if not dummy then
                local vfxFolder = workspace:FindFirstChild("VFX Auras") or workspace:FindFirstChild("VFx") or workspace:FindFirstChild("Effects")
                if vfxFolder then dummy = vfxFolder:FindFirstChild("Dummy") end
            end
            if not dummy then return end
            local humanoid = character:WaitForChild("Humanoid")
            local isR15 = humanoid.RigType == Enum.HumanoidRigType.R15
            local partMapping = {
                ["Head"] = "Head", ["Torso"] = isR15 and "UpperTorso" or "Torso",
                ["Left Arm"] = isR15 and "LeftUpperArm" or "Left Arm", ["Right Arm"] = isR15 and "RightUpperArm" or "Right Arm",
                ["Left Leg"] = isR15 and "LeftUpperLeg" or "Left Leg", ["Right Leg"] = isR15 and "RightUpperLeg" or "Right Leg",
            }
            for sourceName, targetName in pairs(partMapping) do
                local sourcePart = dummy:FindFirstChild(sourceName, true)
                local targetPart = character:FindFirstChild(targetName, true)
                if sourcePart and targetPart then
                    for _, child in ipairs(sourcePart:GetChildren()) do
                        if child:IsA("Attachment") then child:Clone().Parent = targetPart end
                    end
                end
            end
        end
        loadAndCopyVFX()
    end
})

-- ==========================================
-- OUTRAS ABAS (Scripts, Mapa, Ajustes, Social)
-- ==========================================
local Tab = Window:CreateTab("Scripts", 4483362458)
-- [Seções de Shaders e Movimentação originais mantidas aqui]

local SocialTab = Window:CreateTab("Social", 4483362458)
SocialTab:CreateButton({Name = "Copiar Discord", Callback = function() setclipboard("https://discord.gg/bqgVRCWm") end})
SocialTab:CreateButton({Name = "TikTok (@drayko.exe)", Callback = function() setclipboard("https://www.tiktok.com/@drayko.exe") end})
SocialTab:CreateButton({Name = "Brookhaven, new cosmetics script by @l1ght451 (tiktok)", Callback = function() setclipboard("https://www.tiktok.com/@l1ght451") end})

-- [Loops de Heartbeat e InputBegan originais mantidos]

Rayfield:LoadConfiguration()
